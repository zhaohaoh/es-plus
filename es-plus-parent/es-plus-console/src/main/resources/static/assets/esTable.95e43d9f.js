/* empty css             *//* empty css              */import{_ as Z}from"./index.70cde9a5.js";/* empty css                     *//* empty css                *//* empty css                  *//* empty css               *//* empty css               */import{d as G,r as d,o as ee,E as le,a as ae,b as te,T as oe,M as se,c as ue,$ as ne,W as re,e as i,h as v,N as g,F as h,i as x,g as l,w as t,u as T,n as E,a5 as de,a6 as pe,O as ie,Z as ce,t as me,Y as _e,f as F,K as ye,a0 as ve,j as fe,X as ge,_ as he}from"./index.444831c1.js";const be={class:"searchForm",style:{"max-height":"200px","margin-left":"-15px"}},xe={class:"container",style:{"margin-left":"-20px","margin-top":"10px"}},Ee={class:"buju"},we=["onClick"],Ve={class:"right-container",style:{"margin-top":"-20px"}},Ce={class:"downIndex"},ke=G({__name:"esTable",setup(Be){let b=d(!1);const N=d(""),S=d(""),L=()=>{j(S.value)},w=d([{mustType:"must",field:"",searchType:"terms",searchKeyword:"",sortName:"_id",sort:"DESC"}]),f=d({sortName:"_id",sort:"DESC"}),Q=()=>{w.value.push({mustType:"must",field:"",searchType:"terms",searchKeyword:"",sortName:"",sort:""})},A=s=>{w.value.splice(s,1)},V=d([]),M=d([]),D=d();let U=d();const O=d([]),{proxy:K}=fe(),J=async s=>{await z(s),b.value=!0,m.value=s},z=async s=>{const e={indexName:s};let o=await K.$api.esIndex.getMapping(e);N.value=JSON.stringify(o,null,2)},m=d(),R=s=>{m.value=s,D.value=M.value[m.value],U.value=Object.keys(D.value),$()},j=async s=>{const e={keyword:s};let o=await K.$api.esIndex.indexList(e);M.value=o.flatMappings,O.value=o.indices};let C=[];const Y=d("Es.chainQuery()");ee(()=>{j("")});const $=()=>{if(!m.value||m.value==null){ce("\u8BF7\u9009\u62E9\u7D22\u5F15");return}q()},q=async()=>{let s=Y.value+'.index("'+m.value+'")';w.value.forEach(e=>{if(e&&e.searchType&&e.field&&e.searchKeyword){const o=e.mustType;s+="."+o+"()";let p=e.searchKeyword;e.field=="_id"&&(p='"'+e.searchKeyword+'"'),Object.entries(D.value).forEach(([u,n])=>{u==e.field&&(n=="text"||n=="keyword")&&(p='"'+e.searchKeyword+'"'),u==e.field&&n=="long"&&(p=e.searchKeyword+"L")}),s+="."+e.searchType+'("'+e.field+'",'+p+")"}}),s=s+'.sortBy("'+f.value.sort+'","'+f.value.sortName+'")',s+=".search(10)",console.log(s),H(s)},H=async s=>{const e={epl:s},u=(await K.$api.tools.eplQuery(e)).hits.hits.map(n=>n._source);if(u!=null&&u.length>0){let n=Object.keys(u[0]);const y=Object.entries(u[0]),_=[];y.forEach(([c,B])=>{B!=null&&B!==""&&_.push(c)}),n=n.filter(c=>!_.includes(c)),n.unshift(..._);const k=n.indexOf("id");if(k>-1){const[c]=n.splice(k,1);n.unshift(c)}C.length=0,n.forEach(c=>{C.push({prop:c,label:c})}),console.log("\u8868\u5934"+n),console.log("\u8868\u5934:::"+JSON.stringify(C))}V.value=u,console.log(V.value)};return(s,e)=>{const o=le,p=ae,u=te,n=oe,y=se,_=ue,k=ne,c=me,B=ge,P=_e,W=Z,X=re;return i(),v(h,null,[g("div",be,[(i(!0),v(h,null,x(w.value,(a,I)=>(i(),F(_,{key:I,style:{width:"100%","margin-bottom":"5px"},class:"custom-margin"},{default:t(()=>[l(u,{span:3},{default:t(()=>[l(p,{modelValue:a.mustType,"onUpdate:modelValue":r=>a.mustType=r,placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[l(o,{label:"must",value:"must"}),l(o,{label:"should",value:"should"}),l(o,{label:"mustNot",value:"mustNot"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(u,{span:3},{default:t(()=>[l(p,{filterable:"",modelValue:a.field,"onUpdate:modelValue":r=>a.field=r,placeholder:"\u8BF7\u9009\u62E9\u5B57\u6BB5"},{default:t(()=>[l(o,{key:"_id",label:"_id",value:"_id"}),(i(!0),v(h,null,x(T(U),r=>(i(),F(o,{key:r,label:r,value:r},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(u,{span:3},{default:t(()=>[l(p,{modelValue:a.searchType,"onUpdate:modelValue":r=>a.searchType=r,placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[l(o,{label:"terms",value:"terms"}),l(o,{label:"match",value:"match"}),l(o,{label:"wildcard",value:"wildcard"}),l(o,{label:"lt",value:"lt"}),l(o,{label:"le",value:"le"}),l(o,{label:"gt",value:"gt"}),l(o,{label:"ge",value:"ge"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(u,{span:3},{default:t(()=>[l(n,{modelValue:a.searchKeyword,"onUpdate:modelValue":r=>a.searchKeyword=r,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(u,{span:8},{default:t(()=>[l(y,{onClick:Q,type:"primary"},{default:t(()=>e[6]||(e[6]=[E("+")])),_:1}),l(y,{onClick:r=>A(I),type:"danger"},{default:t(()=>e[7]||(e[7]=[E("-")])),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(_,{style:{display:"flex","justify-content":"end","margin-top":"-0px","margin-right":"40px","flex-direction":"row"}},{default:t(()=>[l(u,{span:1}),l(u,{span:3},{default:t(()=>[l(p,{filterable:"",modelValue:f.value.sortName,"onUpdate:modelValue":e[0]||(e[0]=a=>f.value.sortName=a),placeholder:"\u8BF7\u9009\u62E9\u5B57\u6BB5"},{default:t(()=>[(i(!0),v(h,null,x(T(U),a=>(i(),F(o,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{span:2},{default:t(()=>[l(p,{modelValue:f.value.sort,"onUpdate:modelValue":e[1]||(e[1]=a=>f.value.sort=a),placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[l(o,{label:"DESC",value:"DESC"}),l(o,{label:"ASC",value:"ASC"})]),_:1},8,["modelValue"])]),_:1}),l(y,{onClick:$,type:"primary"},{default:t(()=>e[8]||(e[8]=[E(" \u67E5\u8BE2 ")])),_:1})]),_:1})]),g("div",xe,[g("div",Ee,[l(c,{width:"250px"},{default:t(()=>[l(k,{height:"600px"},{default:t(()=>[(i(!0),v(h,null,x(O.value,a=>(i(),v("p",{key:a,class:"scrollbar-demo-item",onClick:I=>R(a),style:ye({background:m.value===a?"#84BEFC":"var(--el-color-primary-light-9)"})},ve(a),13,we))),128))]),_:1})]),_:1}),de(g("div",Ve,[l(_,{gutter:10},{default:t(()=>[l(P,{data:V.value,style:{"max-width":"1200px","max-height":"1000px"},size:"large"},{default:t(()=>[(i(!0),v(h,null,x(T(C),a=>(i(),F(B,{key:a.prop,label:a.label,prop:a.prop,width:"150"},null,8,["label","prop"]))),128))]),_:1},8,["data"])]),_:1}),l(_,{class:"row-bg",justify:"end"},{default:t(()=>[l(u,{span:1},{default:t(()=>[l(y,{type:"success",plain:"",onClick:s.saveClick},{default:t(()=>e[9]||(e[9]=[E("\u65B0\u589E")])),_:1},8,["onClick"])]),_:1})]),_:1})],512),[[pe,V.value.length>0]])])]),g("div",Ce,[l(n,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=a=>S.value=a),placeholder:"\u8BF7\u8F93\u5165\u7D22\u5F15\u540D\u79F0",style:{width:"240px","margin-top":"20px","margin-left":"-15px"},onChange:L},null,8,["modelValue"]),l(y,{type:"primary",onClick:e[3]||(e[3]=a=>J(m.value)),plain:"",style:{width:"240px","margin-top":"20px","margin-left":"-15px"}},{default:t(()=>e[10]||(e[10]=[E("\u67E5\u770B\u6620\u5C04")])),_:1})]),l(X,{modelValue:T(b),"onUpdate:modelValue":e[5]||(e[5]=a=>ie(b)?b.value=a:b=a),title:"\u67E5\u770B\u6620\u5C04",style:{"max-width":"700px",position:"relative",height:"750px",transform:"translateY(-50px)"}},{default:t(()=>[g("div",null,[l(W,{value:N.value,"onUpdate:value":e[4]||(e[4]=a=>N.value=a),height:"600",styles:"width: 100%",title:"\u67E5\u770B\u6620\u5C04"},null,8,["value"])])]),_:1},8,["modelValue"])],64)}}});const Oe=he(ke,[["__scopeId","data-v-2760cc99"]]);export{Oe as default};
